## `Redux-Middleware`

### `왜 Redux-Middleware인가?`

리액트트 웹 어플리케이션에서 API 서버를 연동할 때에는 API 요청애 대한 상태도 잘 관리해야한다.

예를 들어 요청이 시작되었을 때는 로딩중임을, 요청이 성공하거나 실패했을때는 로딩이 끝났음을 명시해야한다.

요청이 성공하면 서버에서 받아 온 응답에 대한 상태를 관리하고, 요청이 실패하면 서버에서 반환한 에러에 대한

상태를 관리해야 한다.

리액트 프로젝트에서 리덕스를 사용하고 있으면서 이러한 비동기 작업을 관리해야한다면 미들웨어를 사용하여

매우 효율적이고 편하게 상태 관리를 할 수 있다.

<br />

### `Middleware란?`

리덕스 미들웨어는 액션을 디스패치 했을 때 리듀서에서 이를 처리하기에 앞서 사전에 지정된

작업들을 실행한다. 즉 미들웨어는 액션과 리듀서 사이의 중간자라고 볼 수 있다.
  > 예를 들어 <br />
  > 전달받은 액션을 단순히 콘솔에 기록. <br />
  > 전달받은 액션 정보를 기반으로 액션을 아예 취소하는 작업

대표적으로 redux-thunk와 redux-saga가 있는데 이 글에서는 redux-thunk를 먼저 다뤄볼 예정이다.

<br />

![redux-middleware](https://user-images.githubusercontent.com/94499416/184522895-3fd1160c-2a98-452d-84f9-9060fe7b965c.png)

<br />

### `Middleware 만들기`

액션이 디스패치 될때마다 액션의 정보와 액션이 디스패치되기 전후의 상태를 콘솔에 보여 주는 로깅 미들웨어를 작성해보자.

<br />

```

const logger_middleware = store => next => action => {
  // 미들웨어 기본 구조
}

export default logger_middleware;

```

<br />

위 코드에서 리덕스 미들웨어의 구조를 볼 수 있는데 코드를 보고 머리가 어질어질 할거다. 

화살표 함수를 연달아서 사용했는데 일반 function을 사용해서 풀어서 쓴다면 다음과 같은 구조다.

<br />

```

const logger_middleware = function logger_middleware(store) {
  return function(next){
    return function(store){
      // 미들웨어 기본 구조
    }
  }
}

```

<br />

미들웨어는 결국 함수를 반환하는 함수이다. 

위 코드에 함수에서 파라미터로 받아오는 파라미터는
  > store -> 리덕스 스토어 <br />
  > action -> 디스패치된 액션

next 파라미터는 함수 형태이며, store.dispatch와 비슷한 역할을 하지만 큰 차이점이 있다.

next를 호출하면 그 다음 처리해야 할 미들웨어에게 액션을 넘겨주고, 만약 그 다음 미들웨어가 없다면




<br />

### `활용 사례?`

온라인 게임의 오픈베타 테스트나 정식 서비스 시작 지점에 클라이언트의 다운로드 수요가 급격하게 증가한다.

이럴 경우 병목 현상이 일어나거나 심한 경우 서버가 다운되기도 때문에 CDN이 필수적으로 사용된다.

또한 대규모 업데이트를 위한 패치가 있을 경우데도 병목 현상을 막기 위해 CDN을 사용한다.

넷플릭스에서는 온라인 동영상 스트리밍 서비스를 전세계로 제공하는 업체로서 

최대한 지연 없이 안정적이고 빠르게 컨텐츠를 제공하기 위해서는 CDN 기술이 필수적이다.
