## `Redux-Middleware`

### `왜 Redux-Middleware인가?`

리액트트 웹 어플리케이션에서 API 서버를 연동할 때에는 API 요청애 대한 상태도 잘 관리해야한다.

예를 들어 요청이 시작되었을 때는 로딩중임을, 요청이 성공하거나 실패했을때는 로딩이 끝났음을 명시해야한다.

요청이 성공하면 서버에서 받아 온 응답에 대한 상태를 관리하고, 요청이 실패하면 서버에서 반환한 에러에 대한

상태를 관리해야 한다.

리액트 프로젝트에서 리덕스를 사용하고 있으면서 이러한 비동기 작업을 관리해야한다면 미들웨어를 사용하여

매우 효율적이고 편하게 상태 관리를 할 수 있다.

<br />

### `Middleware란?`

리덕스 미들웨어는 액션을 디스패치 했을 때 리듀서에서 이를 처리하기에 앞서 사전에 지정된

작업들을 실행한다. 즉 미들웨어는 액션과 리듀서 사이의 중간자라고 볼 수 있다.
  > 예를 들어 <br />
  > 전달받은 액션을 단순히 콘솔에 기록. <br />
  > 전달받은 액션 정보를 기반으로 액션을 아예 취소하는 작업

대표적으로 redux-thunk와 redux-saga가 있는데 이 글에서는 redux-thunk를 먼저 다뤄볼 예정이다.

<br />

![CDN2](https://user-images.githubusercontent.com/94499416/184267344-8f9b96d1-7460-4a63-89fb-3955ec23e624.png)
  > 왼쪽이 CDN 미사용, 오른쪽이 CDN 사용 이미지
<br />

이때 CDN의 동작을 살펴보면 다음과 같은 규칙으로 수행된다.

1. 최초 요청은 서버로부터 컨텐츠를 가져와 고객에게 전송하며 동시에 CDN 캐싱 장비에 저장한다.

2. 최초 요청 이후로의 요청은 CDN에서 지정하는 해당 컨텐츠의 만료 시점까지 캐싱된 컨텐츠를 전송한다.

3. 자주 사용하는 페이지에 한해 캐싱되며, 해당 컨텐츠의 호출이 없을 경우 주기적으로 삭제된다.

4. 서버가 파일을 찾는데 실패할 경우, CDN 플랫폼의 다른 서버에서 컨텐츠를 찾은 다음 엔드 유저에게 응답을 전송한다.

5. 컨텐츠를 사용할 수 없거나 오래된 경우 CDN은 향후 요청에 대해 응답할 수 있도록 새로운 컨텐츠를 저장한다.

<br />

### `CDN 캐싱 방식`

#### `Static Caching`

  - Origin Server에 있는 Contentㄹ르 운영자가 미리 Cache Server에 복사 해두어 사용자가
    Cache Server에 content 요청 시 무조건 Cache Server에 있다.
  
  - 대부분의 국내 CDN에서 이 방식을 사용 (게임 클라이언트 다운로드 등)

#### `Dynamic Caching`
    
  - Origin Server에 있는 컨텐츠를 운영자가 미리 Cache Server에 복사하지 않음
  - 사용자가 컨텐츠를 요청 시 해당 컨텐츠가 없는 경우 Origin Server로부터 다운로드 받아 전달한다.
    있는 경우에는 캐싱된 Content 전달
  - 각각의 Content는 일정 시간 이후 Cache Server에서 삭제 될 수도 있다.

<br />

### `활용 사례?`

온라인 게임의 오픈베타 테스트나 정식 서비스 시작 지점에 클라이언트의 다운로드 수요가 급격하게 증가한다.

이럴 경우 병목 현상이 일어나거나 심한 경우 서버가 다운되기도 때문에 CDN이 필수적으로 사용된다.

또한 대규모 업데이트를 위한 패치가 있을 경우데도 병목 현상을 막기 위해 CDN을 사용한다.

넷플릭스에서는 온라인 동영상 스트리밍 서비스를 전세계로 제공하는 업체로서 

최대한 지연 없이 안정적이고 빠르게 컨텐츠를 제공하기 위해서는 CDN 기술이 필수적이다.
